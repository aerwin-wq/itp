nohup: ignoring input
======================================================================
Pure Contour Re-Pair Pipeline (v53)
======================================================================
Corpus: /home/arlo/do-repo/midi_generator/midi_corpus
Output: checkpoint_v53_pure_contour_1000files.npz
Max files: 1000
Max rules: 10000
Device: cuda

[Phase 1] Loading MIDI files...
  Found 1000 MIDI files
  Loaded 9927 tracks with 4,273,245 notes in 129.9s

[Phase 2] Building pure contour grammar...
[RePair-PureContour] Starting: 9927 tracks, 4,273,245 notes
  [iter 0] R129=contour(0:+unison, r8, v3) count=818,438, len=3,720,143, time=78.0s
  [iter 1] R130=contour(3:+m3, r8, v3) count=350,965, len=3,429,973, time=108.7s
  [iter 2] R131=contour(2:+M2, r8, v3) [HIER] count=337,406, len=3,422,587, time=109.6s
  [iter 3] R132=contour(2:+M2, r8, v3) [HIER] count=330,020, len=3,415,382, time=110.3s
  [iter 4] R133=contour(2:+M2, r8, v3) count=322,815, len=3,223,014, time=131.5s
  [iter 5] R134=contour(-2:-M2, r8, v3) [HIER] count=294,188, len=3,223,001, time=131.5s
  [iter 6] R135=contour(-2:-M2, r8, v3) [HIER] count=294,175, len=3,221,944, time=131.6s
  [iter 7] R136=contour(-2:-M2, r8, v3) [HIER] count=293,118, len=3,220,346, time=131.8s
  [iter 8] R137=contour(-2:-M2, r8, v3) [HIER] count=291,520, len=3,219,849, time=131.9s
  [iter 9] R138=contour(-2:-M2, r8, v3) [HIER] count=291,023, len=3,219,823, time=131.9s
  [iter 100] R229=contour(-1:-m2, r8, v3) [HIER] count=138,972, len=2,442,166, time=222.9s
  [iter 200] R329=contour(-3:-m3, r8, v3) [HIER] count=122,269, len=2,304,150, time=240.4s
  [iter 300] R429=contour(2:+M2, r8, v3) [HIER] count=114,686, len=2,199,398, time=254.2s
  [iter 400] R529=contour(1:+m2, r8, v3) [HIER] count=107,816, len=2,146,585, time=261.1s
  [iter 500] R629=contour(-1:-m2, r8, v3) [HIER] count=103,310, len=2,112,365, time=266.2s
  [iter 600] R729=contour(2:+M2, r8, v3) [HIER] count=99,535, len=2,079,263, time=271.0s
  [iter 700] R829=contour(2:+M2, r8, v3) [HIER] count=96,004, len=2,049,026, time=275.7s
  [iter 800] R929=contour(-1:-m2, r8, v3) [HIER] count=94,364, len=2,040,588, time=277.9s
  [iter 900] R1029=contour(-3:-m3, r8, v3) [HIER] count=93,683, len=2,036,017, time=279.6s
  [iter 1000] R1129=contour(-2:-M2, r8, v3) [HIER] count=92,691, len=2,019,697, time=282.7s
  [iter 1100] R1229=contour(2:+M2, r8, v3) [HIER] count=91,509, len=2,010,126, time=284.9s
  [iter 1200] R1329=contour(-2:-M2, r8, v3) [HIER] count=89,947, len=1,994,343, time=287.8s
  [iter 1300] R1429=contour(7:+P5, r8, v3) [HIER] count=89,105, len=1,988,344, time=289.7s
  [iter 1400] R1529=contour(-3:-m3, r8, v3) [HIER] count=88,214, len=1,951,584, time=294.7s
  [iter 1500] R1629=contour(-5:-P4, r8, v3) [HIER] count=87,557, len=1,943,052, time=296.8s
  [iter 1600] R1729=contour(-1:-m2, r8, v3) [HIER] count=86,813, len=1,937,607, time=298.5s
  [iter 1700] R1829=contour(-5:-P4, r8, v3) [HIER] count=86,111, len=1,929,568, time=300.5s
  [iter 1800] R1929=contour(1:+m2, r8, v3) [HIER] count=85,423, len=1,922,169, time=302.4s
  [iter 1900] R2029=contour(1:+m2, r8, v3) [HIER] count=84,492, len=1,914,883, time=304.4s
  [iter 2000] R2129=contour(-2:-M2, r8, v3) [HIER] count=83,759, len=1,902,846, time=307.0s
  [iter 2100] R2229=contour(-4:-M3, r8, v3) [HIER] count=83,312, len=1,896,515, time=308.8s
  [iter 2200] R2329=contour(1:+m2, r8, v3) [HIER] count=82,363, len=1,873,490, time=312.8s
  [iter 2300] R2429=contour(-5:-P4, r8, v3) [HIER] count=82,162, len=1,870,701, time=314.2s
  [iter 2400] R2529=contour(-4:-M3, r8, v3) [HIER] count=81,786, len=1,868,456, time=315.6s
  [iter 2500] R2629=contour(1:+m2, r8, v3) [HIER] count=81,339, len=1,862,322, time=317.4s
  [iter 2600] R2729=contour(-4:-M3, r8, v3) [HIER] count=80,899, len=1,858,522, time=318.9s
  [iter 2700] R2829=contour(-1:-m2, r8, v3) [HIER] count=80,537, len=1,855,824, time=320.3s
  [iter 2800] R2929=contour(-5:-P4, r8, v3) [HIER] count=79,924, len=1,850,541, time=322.0s
  [iter 2900] R3029=contour(-4:-M3, r8, v3) [HIER] count=79,555, len=1,847,270, time=323.4s
  [iter 3000] R3129=contour(1:+m2, r8, v3) [HIER] count=79,291, len=1,841,378, time=325.1s
  [iter 3100] R3229=contour(-4:-M3, r8, v3) [HIER] count=79,057, len=1,839,151, time=326.4s
  [iter 3200] R3329=contour(5:+P4, r8, v3) [HIER] count=78,758, len=1,835,569, time=327.8s
  [iter 3300] R3429=contour(1:+m2, r8, v3) [HIER] count=78,276, len=1,831,151, time=329.3s
  [iter 3400] R3529=contour(-7:-P5, r8, v3) [HIER] count=77,603, len=1,826,194, time=330.8s
  [iter 3500] R3629=contour(5:+P4, r8, v3) [HIER] count=77,280, len=1,823,808, time=332.0s
  [iter 3600] R3729=contour(1:+m2, r8, v3) [HIER] count=76,937, len=1,819,699, time=333.5s
  [iter 3700] R3829=contour(-2:-M2, r8, v3) [HIER] count=76,598, len=1,811,726, time=335.3s
  [iter 3800] R3929=contour(5:+P4, r8, v3) [HIER] count=76,227, len=1,809,467, time=336.6s
  [iter 3900] R4029=contour(-7:-P5, r8, v3) [HIER] count=75,811, len=1,805,141, time=338.0s
  [iter 4000] R4129=contour(-7:-P5, r8, v3) [HIER] count=75,287, len=1,787,972, time=340.7s
  [iter 4100] R4229=contour(2:+M2, r8, v3) [HIER] count=74,753, len=1,784,935, time=342.0s
  [iter 4200] R4329=contour(-3:-m3, r8, v3) [HIER] count=74,539, len=1,783,355, time=343.2s
  [iter 4300] R4429=contour(-1:-m2, r8, v3) [HIER] count=74,237, len=1,780,381, time=344.5s
  [iter 4400] R4529=contour(5:+P4, r8, v3) [HIER] count=73,909, len=1,776,977, time=345.9s
  [iter 4500] R4629=contour(-2:-M2, r8, v3) [HIER] count=73,706, len=1,775,429, time=347.0s
  [iter 4600] R4729=contour(-2:-M2, r8, v3) [HIER] count=73,500, len=1,773,576, time=348.2s
  [iter 4700] R4829=contour(-7:-P5, r8, v3) [HIER] count=73,021, len=1,762,821, time=350.3s
  [iter 4800] R4929=contour(-3:-m3, r8, v3) [HIER] count=72,674, len=1,757,582, time=351.8s
  [iter 4900] R5029=contour(-1:-m2, r8, v3) [HIER] count=72,235, len=1,754,553, time=353.1s
  [iter 5000] R5129=contour(-7:-P5, r8, v3) [HIER] count=71,864, len=1,751,701, time=354.4s
  [iter 5100] R5229=contour(1:+m2, r8, v3) [HIER] count=71,538, len=1,750,098, time=355.5s
  [iter 5200] R5329=contour(-5:-P4, r8, v3) [HIER] count=71,277, len=1,746,979, time=356.8s
  [iter 5300] R5429=contour(-5:-P4, r8, v3) [HIER] count=70,839, len=1,743,656, time=358.1s
  [iter 5400] R5529=contour(-4:-M3, r8, v3) [HIER] count=70,571, len=1,740,648, time=359.4s
  [iter 5500] R5629=contour(-7:-P5, r8, v3) [HIER] count=70,213, len=1,738,419, time=360.6s
  [iter 5600] R5729=contour(-5:-P4, r8, v3) [HIER] count=70,012, len=1,734,695, time=362.0s
  [iter 5700] R5829=contour(-2:-M2, r8, v3) [HIER] count=69,628, len=1,729,686, time=363.4s
  [iter 5800] R5929=contour(-1:-m2, r8, v3) [HIER] count=69,291, len=1,727,171, time=364.7s
  [iter 5900] R6029=contour(-1:-m2, r8, v3) [HIER] count=69,195, len=1,726,854, time=365.7s
  [iter 6000] R6129=contour(-1:-m2, r8, v3) [HIER] count=69,062, len=1,725,477, time=366.8s
  [iter 6100] R6229=contour(-5:-P4, r8, v3) [HIER] count=68,938, len=1,713,822, time=368.9s
  [iter 6200] R6329=contour(1:+m2, r8, v3) [HIER] count=68,689, len=1,671,783, time=373.9s
  [iter 6300] R6429=contour(5:+P4, r8, v3) [HIER] count=68,479, len=1,670,229, time=375.0s
  [iter 6400] R6529=contour(1:+m2, r8, v3) [HIER] count=68,249, len=1,667,478, time=376.2s
  [iter 6500] R6629=contour(1:+m2, r8, v3) [HIER] count=68,154, len=1,666,284, time=377.3s
  [iter 6600] R6729=contour(1:+m2, r8, v3) [HIER] count=68,070, len=1,665,751, time=378.3s
  [iter 6700] R6829=contour(1:+m2, r8, v3) [HIER] count=67,984, len=1,665,359, time=379.3s
  [iter 6800] R6929=contour(4:+M3, r8, v3) [HIER] count=67,791, len=1,663,993, time=380.3s
  [iter 6900] R7029=contour(1:+m2, r8, v3) [HIER] count=67,498, len=1,660,533, time=381.7s
  [iter 7000] R7129=contour(-3:-m3, r8, v3) [HIER] count=67,248, len=1,659,120, time=382.8s
  [iter 7100] R7229=contour(-5:-P4, r8, v3) [HIER] count=67,090, len=1,655,550, time=384.1s
  [iter 7200] R7329=contour(-3:-m3, r8, v3) [HIER] count=66,823, len=1,654,171, time=385.2s
  [iter 7300] R7429=contour(-1:-m2, r8, v3) [HIER] count=66,627, len=1,652,282, time=386.3s
  [iter 7400] R7529=contour(5:+P4, r8, v3) [HIER] count=66,445, len=1,651,233, time=387.3s
  [iter 7500] R7629=contour(-4:-M3, r8, v3) [HIER] count=66,359, len=1,650,580, time=388.3s
  [iter 7600] R7729=contour(1:+m2, r8, v3) [HIER] count=66,278, len=1,649,414, time=389.4s
  [iter 7700] R7829=contour(5:+P4, r8, v3) [HIER] count=66,161, len=1,646,262, time=390.7s
  [iter 7800] R7929=contour(2:+M2, r8, v3) [HIER] count=66,024, len=1,645,014, time=391.8s
  [iter 7900] R8029=contour(2:+M2, r8, v3) [HIER] count=65,869, len=1,643,763, time=392.8s
  [iter 8000] R8129=contour(5:+P4, r8, v3) [HIER] count=65,597, len=1,641,706, time=393.9s
  [iter 8100] R8229=contour(-2:-M2, r8, v3) [HIER] count=65,447, len=1,640,214, time=395.0s
  [iter 8200] R8329=contour(-2:-M2, r8, v3) [HIER] count=65,277, len=1,638,844, time=396.1s
  [iter 8300] R8429=contour(1:+m2, r8, v3) [HIER] count=65,098, len=1,636,585, time=397.3s
  [iter 8400] R8529=contour(4:+M3, r8, v3) [HIER] count=64,908, len=1,635,266, time=398.3s
  [iter 8500] R8629=contour(2:+M2, r8, v3) [HIER] count=64,839, len=1,634,544, time=399.3s
  [iter 8600] R8729=contour(4:+M3, r8, v3) [HIER] count=64,751, len=1,633,559, time=400.4s
  [iter 8700] R8829=contour(-2:-M2, r8, v3) [HIER] count=64,655, len=1,632,606, time=401.4s
  [iter 8800] R8929=contour(-2:-M2, r8, v3) [HIER] count=64,599, len=1,632,231, time=402.4s
  [iter 8900] R9029=contour(1:+m2, r8, v3) [HIER] count=64,539, len=1,631,630, time=403.4s
  [iter 9000] R9129=contour(-1:-m2, r8, v3) [HIER] count=64,477, len=1,630,786, time=404.4s
  [iter 9100] R9229=contour(0:+unison, r8, v3) [HIER] count=64,402, len=1,629,349, time=405.4s
  [iter 9200] R9329=contour(-5:-P4, r8, v3) [HIER] count=64,295, len=1,627,954, time=406.5s
  [iter 9300] R9429=contour(-3:-m3, r8, v3) [HIER] count=64,176, len=1,626,282, time=407.6s
  [iter 9400] R9529=contour(-3:-m3, r8, v3) [HIER] count=64,096, len=1,625,211, time=408.6s
  [iter 9500] R9629=contour(-4:-M3, r8, v3) [HIER] count=63,907, len=1,623,131, time=409.7s
  [iter 9600] R9729=contour(2:+M2, r8, v3) [HIER] count=63,704, len=1,621,465, time=410.8s
  [iter 9700] R9829=contour(0:+unison, r8, v3) [HIER] count=63,581, len=1,620,269, time=411.9s
  [iter 9800] R9929=contour(-2:-M2, r8, v3) [HIER] count=63,487, len=1,617,886, time=413.0s
  [iter 9900] R10029=contour(-5:-P4, r8, v3) [HIER] count=63,391, len=1,616,182, time=414.1s
[RePair-PureContour] Done: 10000 rules (9985 hierarchical), compression 2.66x, time 415.2s
  Converted 10000 rules (9985 hierarchical) with 2,658,394 occurrences

  Grammar stats:
    Terminals: 128 (rhythm × velocity buckets)
    Rules: 10000
    Compression: 2.66x

[Phase 3] Analyzing patterns...
  Total occurrences: 767,663,052
  Multi-piece patterns: 3424
  Pieces covered: 991
  Rules with merged transpositions: 3955 (TRUE pitch-agnostic)

[Phase 4] Extracting canonical patterns for transform discovery...
  Extracted 10000 canonical patterns

[Phase 5] MDL Transform Discovery on 10000 patterns...

  MDL Transform Discovery on 10000 factored patterns...
  Generated 335 compound candidates
GPU-native transform mining on 10000 patterns...
  Using 335 transform candidates
  Total pairs to process: 2,853,465
  Transform table: torch.Size([335, 12])
  Processing length 4: 352,380 pairs from 840 patterns
  Processing length 3: 247,456 pairs from 704 patterns
  Processing length 5: 669,903 pairs from 1158 patterns
  Processing length 7: 285,390 pairs from 756 patterns
  Processing length 10: 102,378 pairs from 453 patterns
  Processing length 11: 58,311 pairs from 342 patterns
  Processing length 6: 546,535 pairs from 1046 patterns
  Processing length 13: 27,966 pairs from 237 patterns
  Processing length 15: 21,736 pairs from 209 patterns
  Processing length 12: 48,205 pairs from 311 patterns
  Processing length 14: 22,366 pairs from 212 patterns
  Processing length 16: 13,530 pairs from 165 patterns
  Processing length 8: 269,745 pairs from 735 patterns
  Processing length 9: 158,203 pairs from 563 patterns
  Found 9,871 transform relations across 42 transforms
  Extracting cross-track pairs...
    Processing 2658394 pattern occurrences...
  Cross-track pairs: 100000 (3.7s)
  GPU mining 100,000 cross-track pairs...
    Found 2,837 cross-track relations across 23 transforms
  Cross-track relations merged: 2837

Selecting vocabulary via MDL from 42 candidate transforms...
  MDL selection: 10070 unique pairs, 42 transforms
  +identity: 2084 uses, benefit=39594.0 bits
  +R: 1396 uses, benefit=24304.4 bits
  +T5: 354 uses, benefit=5803.9 bits
  +T1∘I3: 346 uses, benefit=5412.6 bits
  +T7: 345 uses, benefit=5200.1 bits
  +I5: 336 uses, benefit=4901.2 bits
  +I0: 325 uses, benefit=4605.6 bits
  +T2: 317 uses, benefit=4377.1 bits
  +I1: 295 uses, benefit=3977.9 bits
  +T1∘I2: 293 uses, benefit=3861.1 bits
  +T10: 284 uses, benefit=3672.4 bits
  +T3: 284 uses, benefit=3603.9 bits
  +T1∘I4: 276 uses, benefit=3435.8 bits
  +T9: 269 uses, benefit=3297.9 bits
  +I5∘R: 262 uses, benefit=3156.4 bits
  +I1∘R: 252 uses, benefit=2990.0 bits
  +I0∘R: 249 uses, benefit=2911.9 bits
  +T10∘R: 249 uses, benefit=2872.0 bits
  +T4: 234 uses, benefit=2667.7 bits
  +I4: 234 uses, benefit=2633.9 bits

Selected 42 transforms, total benefit=173921.5 bits
Covered 10070 of 10070 pairs

(Skipping D24 comparison - using factored patterns)
  Discovered 42 transforms

[Phase 5b] Multi-Factor Transform Discovery (τ, v, d)...
============================================================
MULTI-FACTOR TRANSFORM DISCOVERY
============================================================
Input: 10000 patterns
  Discovering rhythm (τ) transforms on 10000 patterns...
    Checked 3348 same-contour pairs, found 3345 τ relations
    Unique τ transforms: 1
      rhythm:R: 3345 pairs
  Discovering velocity (v) transforms on 10000 patterns...
    Checked 3348 same-contour-rhythm pairs, found 0 v relations
    Unique v transforms: 0
  Discovering duration (d) transforms on 10000 patterns...
    Checked 3348 same-contour-rhythm pairs, found 0 d relations
    Unique d transforms: 0
  Discovering cross-factor relations on 10000 patterns...
    Same rhythm, different pitch: 2878812
    Same contour, different rhythm: 0
    Total cross-factor relations: 2878812

----------------------------------------

  Selecting factor vocabulary via MDL from 1 transforms...
    +rhythm:R: 3345 uses, benefit=46826.0 bits
  Selected 1 factor transforms, total benefit=46826.0 bits

============================================================
MULTI-FACTOR DISCOVERY COMPLETE
============================================================
  Rhythm (τ) transforms: 1
  Velocity (v) transforms: 0
  Duration (d) transforms: 0
  Cross-factor relations: 2878812
  Selected vocabulary: 1

  Top factor transforms by frequency:
    rhythm:R: 3345 uses
  Discovered 1 factor transforms

[Phase 5c] TrackDerive Discovery (Cross-Track Arrangements)...

[TrackDerive Discovery] (GPU-optimized)
  Finding vertical slices...
  Found 374016 vertical slices with 2+ tracks
  Building pattern tensors for 10000 patterns...
  Extracting cross-track pairs from 374016 slices...
  Sampling 500000 from 15357064 pairs...
  GPU matching 500000 cross-track pairs...
  Found 128986 transform matches
  Selecting leaders for 65517 slices with matches...
  Discovered 72797 TrackDerive relationships in 83.4s
  Leader instruments:
    Trumpet: 8804 times
    Piano: 8273 times
    Trombone: 7777 times
    Alto Sax: 6482 times
    Tenor Sax: 6021 times
  Sample derivations:
    Baritone Sax → Alto Sax: identity 
    Trombone → Trombone: identity 
    Flute → Oboe: identity 
    Alto Sax → Baritone Sax: identity 
    GM70 → Tuba: identity 
  Added 'derived_from' to 72797 occurrences
  Added 72797 cross-track derivations to graph

[Phase 5d] Interval Magnitude Discovery (Diatonic vs Chromatic)...

[Interval Magnitude Discovery]
  Building dual transform vocabulary...
    Chromatic transforms: 12 (T0-T11)
    Magnitude classes: 7 (U, 2nd, 3rd, 4th, 5th, 6th, 7th)
    Mapping: {0: [0], 1: [1, 2], 2: [3, 4], 3: [5], 4: [6], 5: [7], 6: [8, 9], 7: [10, 11]}
  Building dual lookup tables...
  Built dual lookup: 16549 transform pairs
  Adding magnitude to occurrences...
  Added magnitude_offset to 2,658,394 occurrences
  Extracting transform sequences...
  Interval magnitude discovery failed: 'onset_time'

[Phase 5e] Feature Importance Discovery (MDL-Based)...

[Feature Importance Discovery]
  Extracting transform transitions...
  Found 41328 transform transitions
  Testing 6 candidate features...
    pitch_offset: 0.0 bits (1.77 → 1.77) ✗ not useful
    track_id: 4212.5 bits (1.77 → 1.67) ✓ USEFUL
    instrument: 4212.5 bits (1.77 → 1.67) ✓ USEFUL
    position_bucket: 229.7 bits (1.77 → 1.77) ✓ USEFUL
    pitch_offset_relative: 0.0 bits (1.77 → 1.77) ✗ not useful
    pitch_offset_delta: 0.0 bits (1.77 → 1.77) ✗ not useful

  track_id clusters:
    I2-preferring: [0, 1, 2, 3, 4, 5, 6, 7]...
    I0-preferring: [30, 31, 66]
    T5-preferring: [28, 51, 67]
    T1∘I3-preferring: [48, 61, 69, 72, 73]
    T7-preferring: [70]
    T11-preferring: [37]
    I4-preferring: [44]

  instrument clusters:
    I2-preferring: [0, 1, 2, 3, 4, 5, 6, 7]...
    I0-preferring: [30, 31, 66]
    T5-preferring: [28, 51, 67]
    T1∘I3-preferring: [48, 61, 69, 72, 73]
    T7-preferring: [70]
    T11-preferring: [37]
    I4-preferring: [44]

  position_bucket clusters:
    I2-preferring: [0, 1, 2, 3, 4, 5, 6, 7]...

  Discovery complete in 6.5s
  Useful features: ['track_id', 'instrument', 'position_bucket']

[Phase 5g] Octave Equivalence Discovery (MDL-Based)...
============================================================
OCTAVE EQUIVALENCE MDL TEST
============================================================
Input: 10000 patterns
  Distinct intervals: 16
  Equivalence classes: 15
  Reduction: 16 -> 15 (6.2% fewer)

  Pattern interval sequences:
    Distinct: 10000
    After equivalence: 8979

  MDL Analysis:
    Distinct cost: 905400.0 bits
      (4.00 bits/interval x 226350 intervals)
    Equivalence cost: 884754.4 bits
      Class: 884324.7 bits (3.91 bits/interval)
      Octave offset: 429.7 bits (0.00 bits/interval)
    MDL benefit: 20645.6 bits

  Octave offset distribution:
    +0 octave(s): 226,320 (100.0%)
    +1 octave(s): 30 (0.0%)

  Patterns with compound intervals (>= octave): 29
    Pattern 6061: [-2, 2, 5, 5, 2, 1, 1, 1, -5, -2, 0, -7, 12, -5, -2, 0, 6, 3, 2]
    Pattern 6064: [-7, 2, 1, 1, 1, 12, -5, -2, 0]
    Pattern 6071: [6, -6, 12, 0, -1, 0, -2, 0]
    Pattern 6094: [6, -6, 12, 0, -1, 0, -2, 0, 12]
    Pattern 6096: [-2, -3, -1, -1, -2, -3, 12, 0]
    ... and 24 more

  Patterns merged by octave equivalence: 444 groups
    [-1, 0]: 14 patterns merged
      <- [-1, 0]
      <- [-1, 0]
      <- [-1, 0]
      ... and 11 more
    [-3, 0]: 14 patterns merged
      <- [-3, 0]
      <- [-3, 0]
      <- [-3, 0]
      ... and 11 more
    [-2, 2]: 12 patterns merged
      <- [-2, 2]
      <- [-2, 2]
      <- [-2, 2]
      ... and 9 more
    [-3, -2]: 12 patterns merged
      <- [-3, -2]
      <- [-3, -2]
      <- [-3, -2]
      ... and 9 more
    [-1, -2]: 11 patterns merged
      <- [-1, -2]
      <- [-1, -2]
      <- [-1, -2]
      ... and 8 more
    ... and 439 more groups

  Decision: Octave equivalence is USEFUL
    MDL benefit 20645.6 > threshold 100.0
  -> Octave equivalence DISCOVERED: 20645.6 bits saved

[Phase 6] Level 3 Meta-Pattern Discovery...
  Building GPU transform lookup table...
    GPU lookup: 10000 patterns × 42 transforms
    Patterns loaded: 0.0s
    Transform table built: 0.0s
    Lookup complete: 19841 relations, 0.3s
  Extracting transform sequences per piece...
    5197 sequences extracted
  Running GPU Re-Pair on transform sequences...
  Meta Re-Pair: 5197 pieces, 40023 transform tokens
  Terminal vocabulary: 42 transforms
[RePair-GPUv2] 5197 seqs, 45,220 tokens, 32 terminals
  [iter 0] R32=(27,27) count=19405, len=40,386, time=0.0s
  [iter 1] R33=(27,27) count=11363, len=38,050, time=0.0s
  [iter 2] R34=(27,27) count=7376, len=36,757, time=0.0s
  [iter 3] R35=(27,27) count=5155, len=36,013, time=0.0s
  [iter 4] R36=(27,27) count=3839, len=35,565, time=0.0s
  [iter 5] R37=(6,6) count=3550, len=34,550, time=0.0s
  [iter 6] R38=(27,27) count=3005, len=34,234, time=0.0s
  [iter 7] R39=(27,27) count=2423, len=34,012, time=0.0s
  [iter 8] R40=(32,33) count=2336, len=31,676, time=0.0s
  [iter 9] R41=(6,6) count=2082, len=31,387, time=0.0s
  [iter 100] R132=(6,6) count=249, len=22,791, time=0.1s
  [iter 200] R232=(8,8) count=115, len=20,607, time=0.2s
  [iter 300] R332=(4,4) count=63, len=18,962, time=0.3s
  [iter 400] R432=(8,8) count=33, len=17,700, time=0.4s
  [iter 500] R532=(55,55) count=18, len=16,551, time=0.5s
  [iter 600] R632=(2,58) count=10, len=15,660, time=0.6s
  [iter 700] R732=(622,622) count=7, len=15,059, time=0.7s
  [iter 800] R832=(326,32) count=5, len=14,565, time=0.8s
[RePair-GPUv2] Done: 829 rules, compression 4.89x, time 0.9s
  Discovered 829 meta-patterns
  Compression: 4.89x

  Top Meta-Patterns:
    M0: I2 → I2
    M1: I2 → I2
    M2: I2 → I2
    M3: I2 → I2
    M4: I2 → I2
    M5: I0 → I0
    M6: I2 → I2
    M7: I2 → I2
    M8: I2 → I2 → I2 → I2
    M9: I0 → I0
  Discovered 829 horizontal meta-patterns
  Aggregating orchestration rules (vertical slices)...
  Found 508840 vertical slices (2+ concurrent patterns)
  Processing 3716373 cross-track pattern pairs on GPU
    Using batched processing: 99273 pairs per batch (38 batches)
  Orchestration rules found: 2302
    Synth Strings 2 -> Orchestra Hit: identity (100.0%, n=37)
    Synth Strings 2 -> Piano: identity (100.0%, n=30)
    Orchestra Hit -> Acoustic Bass: identity (100.0%, n=19)
    Alto Sax -> Orchestra Hit: identity (100.0%, n=12)
    Tenor Sax -> Synth Strings 2: identity (100.0%, n=92)
    Tenor Sax -> Orchestra Hit: identity (100.0%, n=15)
    Baritone Sax -> Synth Strings 2: identity (100.0%, n=40)
    Baritone Sax -> Orchestra Hit: identity (100.0%, n=11)
    Trumpet -> Orchestra Hit: identity (100.0%, n=21)
    Electric Piano 1 -> Electric Piano 2: identity (100.0%, n=8)
  Found 2302 orchestration rules

[Phase 7] Saving checkpoint...
  Saving patterns JSON to checkpoint_v53_pure_contour_1000files_patterns.json...
  Checkpoint saved to: checkpoint_v53_pure_contour_1000files.npz

======================================================================
PIPELINE COMPLETE
======================================================================
  Files: 1000 loaded, 0 failed
  Tracks: 9927
  Notes: 4,273,245
  Patterns: 10000
  Compression: 2.66x
  Total occurrences: 767,663,052
  Multi-piece patterns: 3424
  Rules with merged transpositions: 3955
  Transform vocabulary (pitch): 42
  Total time: 792.5s

  Output: checkpoint_v53_pure_contour_1000files.npz
